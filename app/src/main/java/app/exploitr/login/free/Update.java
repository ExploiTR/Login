package app.exploitr.login.free;

import com.crashlytics.android.Crashlytics;

import java.io.IOException;

import okhttp3.Call;
import okhttp3.Callback;
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;
import okhttp3.ResponseBody;

interface Checker {
	void done(long version);
}

class Update {
	private static final String VER_URL = "https://raw.githubusercontent.com/ExploiTR/Login/master/version";
	
	static void update(Checker chk) {
		new OkHttpClient().newCall(new Request.Builder()
				.url(VER_URL)
				.get()
				.build()).enqueue(new Callback() {
			@Override
			public void onFailure(Call call, IOException e) {
			
			}
			
			@Override
			public void onResponse(Call call, Response response) {
				try (ResponseBody responseBody = response.body(); Response res = response) {
					if (res.isSuccessful() && responseBody != null) {
						chk.done(Long.parseLong(responseBody.string().trim()));
					}
				} catch (Exception e) {
					e.printStackTrace();
					Crashlytics.logException(e);
				}
			}
		});
	}
}
